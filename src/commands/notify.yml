description: >
  This command will post a notification to the MS teams webhook url, containing deployment info.

parameters:
  webhook_url:
    description: The MS Teams Webhook URL
    type: string
  deployed_env:
    description: The environment being deployed
    type: string
steps:
  - run:
      environment:
        deployed_env: << parameters.deployed_env >>
        webhook_url: << parameters.webhook_url >>
        CIRCLE_SHA1: $CIRCLE_SHA1
        CIRCLE_PROJECT_USERNAME: $CIRCLE_PROJECT_USERNAME
        CIRCLE_PROJECT_REPONAME: $CIRCLE_PROJECT_REPONAME
        CIRCLE_BRANCH: $CIRCLE_BRANCH
        CIRCLE_USERNAME: $CIRCLE_USERNAME
        CIRCLE_REPOSITORY_URL: $CIRCLE_REPOSITORY_URL
      name: Notify MS Teams
      when: on_sucess
      command: <<include(scripts/notify.sh)>>
