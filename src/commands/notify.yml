description: >
  This command will post a notification to the MS teams webhook url, containing deployment info.

parameters:
  DEPLOYED_ENV:
    description: The environment being deployed
    type: string
  WEBHOOK_URL:
    description: The configured URL for the message to be posted to
    type: string
steps:
  - run:
      when: on_success
      environment:
        DEPLOYED_ENV: << parameters.DEPLOYED_ENV >>
        WEBHOOK_URL: << parameters.WEBHOOK_URL >>
        STATUS: "SUCCESS"
      name: Notify MS Teams of successful deployment
      command: <<include(scripts/notify.sh)>>
  - run:
      when: on_fail
      environment:
        DEPLOYED_ENV: << parameters.DEPLOYED_ENV >>
        WEBHOOK_URL: << parameters.WEBHOOK_URL >>
        STATUS: "FAIL"
      name: Notify MS Teams of successful deployment
      command: <<include(scripts/notify.sh)>>
